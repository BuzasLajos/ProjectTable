<p>When using these formulae, one must ensure that <span class="texhtml"><i>h</i></span> does not exceed 1 due to a <a href="https://en.wikipedia.org/wiki/Floating_point" class="mw-redirect" title="Floating point">floating point</a> error (<span class="texhtml"><i>d</i></span> is only <a href="https://en.wikipedia.org/wiki/Real_number" title="Real number">real</a> for <span class="texhtml"><i>h</i></span> from 0 to 1). <span class="texhtml"><i>h</i></span> only approaches 1 for <i>antipodal</i> points (on opposite sides of the sphere)—in this region, relatively large numerical errors tend to arise in the formula when finite precision is used. Because <span class="texhtml"><i>d</i></span> is then large (approaching <span class="texhtml">π<i>R</i></span>, half the circumference) a small error is often not a major concern in this unusual case (although there are other <a href="https://en.wikipedia.org/wiki/Great-circle_distance" title="Great-circle distance">great-circle distance</a> formulas that avoid this problem). (The formula above is sometimes written in terms of the <a href="https://en.wikipedia.org/wiki/Arctangent" class="mw-redirect" title="Arctangent">arctangent</a> function, but this suffers from similar numerical problems near <span class="texhtml"><i>h</i></span> = 1.)</p>
<p>As described below, a similar formula can be written using cosines (sometimes called the <a href="https://en.wikipedia.org/wiki/Spherical_law_of_cosines" title="Spherical law of cosines">spherical law of cosines</a>, not to be confused with the <a href="https://en.wikipedia.org/wiki/Law_of_cosines" title="Law of cosines">law of cosines</a> for plane geometry) instead of haversines, but if the two points are close together (e.g. a kilometer apart, on the Earth) you might end up with <span class="texhtml">cos(<span class="sfrac nowrap" style="display:inline-block; vertical-align:-0.5em; font-size:85%; text-align:center;"><span style="display:block; line-height:1em; margin:0 0.1em;"><i>d</i></span><span class="visualhide">/</span><span style="display:block; line-height:1em; margin:0 0.1em; border-top:1px solid;"><i>R</i></span></span>)</span> = 0.99999999, leading to an inaccurate answer. Since the haversine formula uses sines it avoids that problem.</p>
<p>Either formula is only an approximation when applied to the <a href="https://en.wikipedia.org/wiki/Earth" title="Earth">Earth</a>, which is not a perfect sphere: the "<a href="https://en.wikipedia.org/wiki/Earth_radius" title="Earth radius">Earth radius</a>" <span class="texhtml"><i>R</i></span> varies from 6356.752&nbsp;km at the poles to 6378.137&nbsp;km at the equator. More importantly, the <a href="https://en.wikipedia.org/wiki/Radius_of_curvature_(applications)" class="mw-redirect" title="Radius of curvature (applications)">radius of curvature</a> of a north-south line on the earth's surface is 1% greater at the poles (≈6399.594&nbsp;km) than at the equator (≈6335.439&nbsp;km)—so the haversine formula and law of cosines cannot be guaranteed correct to better than <a rel="nofollow" class="external text" href="http://www.movable-type.co.uk/scripts/latlong.html">0.5%</a>. More accurate methods that consider the Earth's ellipticity are given by <a href="https://en.wikipedia.org/wiki/Vincenty%27s_formulae" title="Vincenty&#39;s formulae">Vincenty's formulae</a> and the other formulas in the <a href="https://en.wikipedia.org/wiki/Geographical_distance" title="Geographical distance">geographical distance</a> article.</p>